(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7591a10d"],{1e3:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"detail"}},[a("van-overlay",{staticClass:"loadBox",attrs:{show:t.load,"z-index":1e4,"lock-scroll":!0}},[t.load?a("van-loading",{staticClass:"load",attrs:{type:"spinner",color:"#1989fa",vertical:!0}}):t._e()],1),a("div",{staticClass:"content"},[a("div",{staticClass:"swiperBox"},[a("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3}},t._l(t.data.acImages,(function(t,e){return a("van-swipe-item",{key:e},[a("img",{attrs:{src:t,alt:""}})])})),1)],1),a("div",{staticClass:"tip"},[t._v(" 《亮剑》导演张前执导 CCTV-1黄金档同步热播 新时光全网独家 ")]),a("div",{staticClass:"videoBaseInfo"},[a("div",{staticClass:"videoTitle"},[a("div",{staticClass:"posterBox"},[a("img",{attrs:{src:t.data.poster_v,alt:""}})]),a("div",{staticClass:"rightBox"},[a("p",{staticClass:"videoName"},[t._v(t._s(t.data.name))]),a("p",[a("span",{staticClass:"episodes"},[t._v("共"+t._s(t.data.video_num)+"集")]),t._l(t.data.tags,(function(e,i){return a("span",{key:i},[0!==i?a("span",[t._v("/")]):t._e(),t._v(" "+t._s(e)+" ")])}))],2),a("p",[t._v("导演 ："+t._s(t.director.name))]),a("p",[t._v(" 领衔主演 ："),t._l(t.actors,(function(e,i){return a("span",{key:i},[t._v(t._s(e.actor.name)+"、")])}))],2)])]),a("div",{staticClass:"videoBrief"},[a("div",{staticClass:"BriefBox",class:{shrink:t.showToggleBtn&&t.showVideoBrief}},[a("div",{ref:"videoBriefText",staticClass:"videoBriefText",domProps:{innerHTML:t._s(t.introduction)}}),t.showToggleBtn&&t.showVideoBrief?a("div",{staticClass:"ellipsis"},[t._v(" ... ")]):t._e()]),t.showToggleBtn?a("p",{staticClass:"changeBrief",on:{click:t.changeBrief}},[t._v(" "+t._s(t.showVideoBrief?"展开":"收起")+" ")]):t._e()]),a("div",{staticClass:"videoDetail",domProps:{innerHTML:t._s(t.data.intro)}}),a("div",{staticClass:"videoBuy"},[a("div",{staticClass:"price"},[a("span",{staticClass:"realPrice"},[t._v("￥"+t._s(t.data.real_price))]),a("span",{staticClass:"deletePrice"},[t._v("￥"+t._s(t.data.price))]),a("span",{staticClass:"rightMarker"},[t._v(t._s(t.data.video_num)+"集")])]),a("div",{staticClass:"tryWatch"},[a("wx-open-launch-weapp",{attrs:{id:"toWeapp",username:"gh_1653716eeae2",path:"/pages/videoDetail/videoDetail.html"},on:{error:t.handleWeappError,launch:t.handleWeappLaunch}},[a("p",[t._v("免费试看")])])],1),t.data.is_buy?a("div",{staticClass:"buyNow"},[t._v("已购买")]):a("div",{staticClass:"buyNow",on:{click:t.WXPay}},[t._v("立即抢购")])]),a("div",{staticClass:"shareBtn",on:{click:t.toShare}},[a("p",[t._v("邀请好友得")]),a("p",[a("span",[t._v(t._s(t.data.distribute_money))]),t._v(" 元 ")])])])]),a("to-home",{attrs:{toWhere:"personalCenter"}}),t.showInviter?a("invite-login",{attrs:{showInviter:t.showInviter,from_user_id:t.from_user_id,ac_id:t.ac_id},on:{closeDialog:t.closeDialog}}):t._e()],1)},s=[],o=(a("4de4"),a("7db0"),a("a9e3"),a("ac1f"),a("5319"),a("841c"),a("1276"),a("0a14")),n=a("8e0a"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"inviteLogin"}},[a("van-dialog",{class:{loginTrue:t.loginStatus},attrs:{"show-confirm-button":!1},scopedSlots:t._u([{key:"title",fn:function(){return[a("p",{staticClass:"avatar"},[a("img",{attrs:{src:t.dialogData.avatar}})]),a("i",{staticClass:"closeBtn iconfont icon-guanbi3",on:{click:t.closeDialog}})]},proxy:!0}]),model:{value:t.showInviter,callback:function(e){t.showInviter=e},expression:"showInviter"}},[[t.load?a("div",{staticClass:"loadBox"},[t.load?a("van-loading",{staticClass:"load",attrs:{type:"spinner",color:"#1989fa",vertical:!0}}):t._e()],1):t._e(),a("div",{staticClass:"inviter"},[a("p",{staticClass:"name"},[t._v(t._s(t.dialogData.user_name))]),a("p",{staticClass:"tip"},[t._v(" 邀您1元看大剧《"+t._s(t.dialogData.program_name)+"》，重温乒乓王者路 ")])]),t.loginStatus?a("div",{staticClass:"btnBox"},[a("van-button",{attrs:{type:"info"},on:{click:t.closeDialog}},[t._v("确认")])],1):a("van-form",{ref:"formRef",staticClass:"formBox",on:{submit:t.login}},[a("van-cell-group",{staticClass:"formCell telBox"},[a("van-field",{attrs:{placeholder:"请输入手机号",rules:t.formRule.tel,error:!1,name:"tel",type:"number"},model:{value:t.formData.tel,callback:function(e){t.$set(t.formData,"tel",e)},expression:"formData.tel"}})],1),a("van-cell-group",{staticClass:"formCell codeBox"},[a("van-field",{attrs:{placeholder:"请输入验证码",rules:t.formRule.code,error:!1,name:"code",type:"number",maxlength:4},scopedSlots:t._u([{key:"button",fn:function(){return[a("van-button",{staticClass:"getCodeBtn",class:{notClick:!t.getCodeFlag},attrs:{round:"",block:"",type:"info","native-type":"button",disabled:!t.getCodeFlag},on:{click:t.getCode}},[t.intervalFlag?a("span",[t._v("("+t._s(t.times)+")")]):t._e(),t._v(" 获取验证码 ")])]},proxy:!0}],null,!1,1907922443),model:{value:t.formData.code,callback:function(e){t.$set(t.formData,"code",e)},expression:"formData.code"}})],1),a("van-cell-group",{staticClass:"formCell submitBox"},[a("van-button",{staticClass:"submitBtn",attrs:{round:"",block:"",type:"info","native-type":"submit"}},[t._v("接受邀请")])],1)],1)]],2)],1)},l=[],c={name:"inviteLogin",props:["showInviter","from_user_id","ac_id"],data:function(){var t=function(t,e){var a=/^\d+$|^\d+[.]?\d+$/;return a.test(t)&&4==t.length};return{loginStatus:!1,getCodeFlag:!0,loginFlag:!0,intervalFlag:!1,load:!1,times:60,dialogData:{},formData:{tel:"",code:"",codeKey:""},formRule:{tel:[{required:!0,message:"手机号不可为空",trigger:"onChange"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确格式的手机号",trigger:"onChange"}],code:[{required:!0,message:"验证码不可为空",trigger:"onChange"},{validator:t,message:"验证码为长度为4的数字",trigger:"onChange"}]}}},created:function(){this.loginStatus=this.testToken(),this.getData()},methods:{getData:function(){var t=this;this.load=!0;var e={from_user_id:this.from_user_id,ac_id:this.ac_id};console.log(e),Object(o["e"])(e).then((function(e){console.log(e),t.dialogData=e.data,t.load=!1}))},testToken:function(){if(this.$store.state.appUserInfo.token){var t=new Date(this.$store.state.appUserInfo.expired_at);t=t.getTime();var e=(new Date).getTime();return!(e>t)}return!1},closeDialog:function(){this.$emit("closeDialog")},getCode:function(){var t=this;this.$refs.formRef.validate("tel").then((function(e){if(t.getCodeFlag){t.getCodeFlag=!1;var a={mobile:t.formData.tel};Object(o["g"])(a).then((function(e){if(1e3==e.code){t.times=60,t.intervalFlag=!0;var a=t,i=setInterval((function(){a.times<=0&&(a.getCodeFlag=!0,a.intervalFlag=!1,clearInterval(i)),a.times--}),1e3);t.formData.codeKey=e.key,t.$toast({position:"top",message:"发送验证码成功!"})}else t.$toast({position:"top",message:e.message})}))}})).catch((function(t){console.log(t)}))},login:function(t){var e=this;if(this.formData.codeKey){if(!this.loginFlag)return;this.loginFlag=!1;var a={mobile:this.formData.tel,user_id:this.$store.state.WXUserInfo.id,verification_key:this.formData.codeKey,verification_code:this.formData.code,openid:this.$store.state.WXUserInfo.open_id};Object(o["a"])(a).then((function(t){if(console.log(t),e.loginFlag=!0,"success"==t.status){e.$store.commit("setAppUserInfo",{token:t.token,expired_at:t.expired_at,id:t.data.id});var a={ac_id:e.$store.state.distributionInfo.ac_id,user_id:t.data.id};Object(o["b"])(a).then((function(t){})),e.closeDialog()}else e.$toast({position:"top",message:t.message})}))}else this.$toast({position:"top",message:"请先获取验证码"})}}},d=c,u=(a("6fe9"),a("2877")),f=Object(u["a"])(d,r,l,!1,null,"5e3f2ac4",null),h=f.exports,g={components:{toHome:n["a"],inviteLogin:h},data:function(){return{introduction:"",showToggleBtn:!1,showVideoBrief:!0,load:!1,getDataFlag:!0,data:{},is_buy:!1,showInviter:!1,ac_id:0,from_user_id:0,director:{},actors:[]}},created:function(){this.$shareConfig();var t=this.getUrlParam("ac_id"),e=this.getUrlParam("from_user_id");t&&e&&Number(t)&&Number(e)&&this.$store.commit("setDistributionInfo",{ac_id:Number(t),from_user_id:Number(e)}),this.$store.state.distributionInfo.ac_id&&this.$store.state.distributionInfo.from_user_id?this.getData():this.$router.push("/errorPage"),t&&e&&(this.ac_id=this.$store.state.distributionInfo.ac_id,this.from_user_id=this.$store.state.distributionInfo.from_user_id,this.showInviter=!0)},methods:{closeDialog:function(){this.showInviter=!1},getUrlParam:function(t){for(var e=window.location.search.substr(1).split("&"),a=0;a<e.length;a++)if(e[a].split("=")[0]==t)return e[a].split("=")[1];return!1},getData:function(){var t=this;if(this.load=!0,this.getDataFlag){this.getDataFlag=!1;var e={ac_id:this.$store.state.distributionInfo.ac_id,user_id:this.$store.state.WXUserInfo.id?this.$store.state.WXUserInfo.id:""};Object(o["d"])(e).then((function(e){console.log(e),t.data=e,t.actors=e.actors.filter((function(t,e,a){return"导演"!==t.actor_name})),t.director=e.actors.find((function(t,e,a){return"导演"==t.actor_name})).actor,t.introduction=e.introduction,t.is_buy=e.is_buy,t.load=!1,t.getDataFlag=!0}))}},WXPay:function(){var t=this;if(this.$store.state.appUserInfo.token)if(this.$store.state.WXUserInfo.id){var e={ac_id:this.$store.state.distributionInfo.ac_id,from_user_id:this.$store.state.distributionInfo.from_user_id,user_id:this.$store.state.WXUserInfo.id,openid:this.$store.state.WXUserInfo.open_id};Object(o["j"])(e).then((function(e){console.log(e),t.$payConfig(e.timeStamp,e.nonceStr,e.package,e.signType,e.paySign,(function(t){alert(JSON.stringify(t)),alert(JSON.stringify(this)),alert(JSON.stringify(router)),alert("支付成功"),router.push({name:"payResult",query:{result:!0}})}),(function(t){alert(JSON.stringify(t)),alert(JSON.stringify(this)),alert("支付失败"),router.push({name:"payResult",query:{result:!0}})}))}))}else{var a=encodeURI(window.location.origin+this.$route.path);location.replace("https://app.newtiming.com/api/v1/socials/authorizations?redirect_url="+a+"&user_id="+this.$store.state.appUserInfo.id)}else this.$router.push("/login")},toUser:function(){this.$router.push({name:"personalCenter"})},toShare:function(){this.$router.push({name:"share"})},handleWeappError:function(){console.log("跳转失败")},handleWeappLaunch:function(){console.log("跳转成功")},changeBrief:function(){this.showVideoBrief=!this.showVideoBrief}},watch:{introduction:function(){this.$nextTick((function(){var t=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).height),e=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).lineHeight);console.log(t,e),t>3*e?(console.log(1),this.showToggleBtn=!0):(console.log(2),this.showToggleBtn=!1)}))}}},p=g,v=(a("47ea"),Object(u["a"])(p,i,s,!1,null,"c68b139e",null));e["default"]=v.exports},"2fe9":function(t,e,a){},"47ea":function(t,e,a){"use strict";var i=a("7b4c"),s=a.n(i);s.a},"6fe9":function(t,e,a){"use strict";var i=a("9d91"),s=a.n(i);s.a},"7b4c":function(t,e,a){},"7db0":function(t,e,a){"use strict";var i=a("23e7"),s=a("b727").find,o=a("44d2"),n=a("ae40"),r="find",l=!0,c=n(r);r in[]&&Array(1)[r]((function(){l=!1})),i({target:"Array",proto:!0,forced:l||!c},{find:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),o(r)},"8e0a":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"toHome"},on:{click:t.toPages}},["detail"==t.toWhere?a("i",{staticClass:"iconfont icon-iconfontshangchengweijihuoeps"}):t._e(),"personalCenter"==t.toWhere?a("i",{staticClass:"iconfont icon-shouye1 toDetail"}):t._e(),"personalCenter"==t.toWhere?a("p",[t._v("个人中心")]):t._e(),"detail"==t.toWhere?a("p",[t._v("返回")]):t._e()])},s=[],o={name:"toHome",props:["toWhere"],methods:{toPages:function(){this.$router.push(this.toWhere)}}},n=o,r=(a("a6be"),a("2877")),l=Object(r["a"])(n,i,s,!1,null,"1da08a80",null);e["a"]=l.exports},"9d91":function(t,e,a){},a6be:function(t,e,a){"use strict";var i=a("2fe9"),s=a.n(i);s.a}}]);
//# sourceMappingURL=chunk-7591a10d.af5a3e7b.js.map