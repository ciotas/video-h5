(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49df3d53"],{"0175":function(t,e,i){"use strict";var a=i("d5c0"),s=i.n(a);s.a},1e3:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"detail"}},[i("van-overlay",{staticClass:"loadBox",attrs:{show:t.load,"z-index":1e4,"lock-scroll":!0}},[t.load?i("van-loading",{staticClass:"load",attrs:{type:"spinner",color:"#1989fa",vertical:!0}}):t._e()],1),i("div",{staticClass:"content"},[i("div",{staticClass:"swiperBox"},[i("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3}},t._l(t.data.acImages,(function(t,e){return i("van-swipe-item",{key:e},[i("img",{attrs:{src:t,alt:""}})])})),1)],1),i("div",{staticClass:"tip"},[t._v(" 《亮剑》导演张前执导 CCTV-1黄金档同步热播 新时光全网独家 ")]),i("div",{staticClass:"videoBaseInfo"},[i("div",{staticClass:"videoTitle"},[i("div",{staticClass:"posterBox"},[i("img",{attrs:{src:t.data.poster_v,alt:""}})]),i("div",{staticClass:"rightBox"},[i("p",{staticClass:"videoName"},[t._v(t._s(t.data.name))]),i("p",[i("span",{staticClass:"episodes"},[t._v("共"+t._s(t.data.video_num)+"集")]),t._l(t.data.tags,(function(e,a){return i("span",{key:a},[0!==a?i("span",[t._v("/")]):t._e(),t._v(" "+t._s(e)+" ")])}))],2),i("p",[t._v("导演 ："+t._s(t.director.name))]),i("p",[t._v(" 领衔主演 ："),t._l(t.actors,(function(e,a){return i("span",{key:a},[t._v(t._s(e.actor.name)+"、")])}))],2)])]),i("div",{staticClass:"videoBrief"},[i("div",{staticClass:"BriefBox",class:{shrink:t.showToggleBtn&&t.showVideoBrief}},[i("div",{ref:"videoBriefText",staticClass:"videoBriefText",domProps:{innerHTML:t._s(t.introduction)}}),t.showToggleBtn&&t.showVideoBrief?i("div",{staticClass:"ellipsis"},[t._v(" ... ")]):t._e()]),t.showToggleBtn?i("p",{staticClass:"changeBrief",on:{click:t.changeBrief}},[t._v(" "+t._s(t.showVideoBrief?"展开":"收起")+" ")]):t._e()]),i("div",{staticClass:"videoDetail",domProps:{innerHTML:t._s(t.data.intro)}}),i("div",{staticClass:"videoBuy"},[i("div",{staticClass:"price"},[i("span",{staticClass:"realPrice"},[t._v("￥"+t._s(t.data.real_price))]),i("span",{staticClass:"deletePrice"},[t._v("￥"+t._s(t.data.price))]),i("span",{staticClass:"rightMarker"},[t._v(t._s(t.data.video_num)+"集")])]),i("div",{staticClass:"tryWatch"},[i("wx-open-launch-weapp",{attrs:{id:"toWeapp",username:"gh_1653716eeae2",path:"/pages/videoDetail/videoDetail.html"},on:{error:t.handleWeappError,launch:t.handleWeappLaunch}},[i("p",[t._v("免费试看")])])],1),t.data.is_buy?i("div",{staticClass:"buyNow"},[t._v("已购买")]):i("div",{staticClass:"buyNow",on:{click:t.WXPay}},[t._v("立即抢购")])]),i("div",{staticClass:"shareBtn",on:{click:t.toShare}},[i("p",[t._v("邀请好友得")]),i("p",[i("span",[t._v(t._s(t.data.distribute_money))]),t._v(" 元 ")])])])]),i("to-home",{attrs:{toWhere:"personalCenter"}}),t.showInviter?i("invite-login",{attrs:{showInviter:t.showInviter,from_user_id:t.from_user_id,ac_id:t.ac_id},on:{closeDialog:t.closeDialog}}):t._e()],1)},s=[],o=(i("4de4"),i("7db0"),i("a9e3"),i("ac1f"),i("5319"),i("841c"),i("1276"),i("0a14")),n=i("8e0a"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"inviteLogin"}},[i("van-dialog",{class:{loginTrue:t.loginStatus},attrs:{"show-confirm-button":!1},scopedSlots:t._u([{key:"title",fn:function(){return[i("p",{staticClass:"avatar"},[i("img",{attrs:{src:t.dialogData.avatar}})]),i("i",{staticClass:"closeBtn iconfont icon-guanbi3",on:{click:t.closeDialog}})]},proxy:!0}]),model:{value:t.showInviter,callback:function(e){t.showInviter=e},expression:"showInviter"}},[[t.load?i("div",{staticClass:"loadBox"},[t.load?i("van-loading",{staticClass:"load",attrs:{type:"spinner",color:"#1989fa",vertical:!0}}):t._e()],1):t._e(),i("div",{staticClass:"inviter"},[i("p",{staticClass:"name"},[t._v(t._s(t.dialogData.user_name))]),i("p",{staticClass:"tip"},[t._v(" 邀您1元看大剧《"+t._s(t.dialogData.program_name)+"》，重温乒乓王者路 ")])]),t.loginStatus?i("div",{staticClass:"btnBox"},[i("van-button",{attrs:{type:"info"},on:{click:t.closeDialog}},[t._v("确认")])],1):i("van-form",{ref:"formRef",staticClass:"formBox",on:{submit:t.login}},[i("van-cell-group",{staticClass:"formCell telBox"},[i("van-field",{attrs:{placeholder:"请输入手机号",rules:t.formRule.tel,error:!1,name:"tel",type:"number"},model:{value:t.formData.tel,callback:function(e){t.$set(t.formData,"tel",e)},expression:"formData.tel"}})],1),i("van-cell-group",{staticClass:"formCell codeBox"},[i("van-field",{attrs:{placeholder:"请输入验证码",rules:t.formRule.code,error:!1,name:"code",type:"number",maxlength:4},scopedSlots:t._u([{key:"button",fn:function(){return[i("van-button",{staticClass:"getCodeBtn",class:{notClick:!t.getCodeFlag},attrs:{round:"",block:"",type:"info","native-type":"button",disabled:!t.getCodeFlag},on:{click:t.getCode}},[t.intervalFlag?i("span",[t._v("("+t._s(t.times)+")")]):t._e(),t._v(" 获取验证码 ")])]},proxy:!0}],null,!1,1907922443),model:{value:t.formData.code,callback:function(e){t.$set(t.formData,"code",e)},expression:"formData.code"}})],1),i("van-cell-group",{staticClass:"formCell submitBox"},[i("van-button",{staticClass:"submitBtn",attrs:{round:"",block:"",type:"info","native-type":"submit"}},[t._v("接受邀请")])],1)],1)]],2)],1)},l=[],c={name:"inviteLogin",props:["showInviter","from_user_id","ac_id"],data:function(){var t=function(t,e){var i=/^\d+$|^\d+[.]?\d+$/;return i.test(t)&&4==t.length};return{loginStatus:!1,getCodeFlag:!0,loginFlag:!0,intervalFlag:!1,load:!1,times:60,dialogData:{},formData:{tel:"",code:"",codeKey:""},formRule:{tel:[{required:!0,message:"手机号不可为空",trigger:"onChange"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确格式的手机号",trigger:"onChange"}],code:[{required:!0,message:"验证码不可为空",trigger:"onChange"},{validator:t,message:"验证码为长度为4的数字",trigger:"onChange"}]}}},created:function(){this.loginStatus=this.testToken(),this.getData()},methods:{getData:function(){var t=this;this.load=!0;var e={from_user_id:this.from_user_id,ac_id:this.ac_id};console.log(e),Object(o["e"])(e).then((function(e){console.log(e),t.dialogData=e.data,t.load=!1}))},testToken:function(){if(this.$store.state.appUserInfo.token){var t=new Date(this.$store.state.appUserInfo.expired_at);t=t.getTime();var e=(new Date).getTime();return!(e>t)}return!1},closeDialog:function(){this.$emit("closeDialog")},getCode:function(){var t=this;this.$refs.formRef.validate("tel").then((function(e){if(t.getCodeFlag){t.getCodeFlag=!1;var i={mobile:t.formData.tel};Object(o["g"])(i).then((function(e){if(1e3==e.code){t.times=60,t.intervalFlag=!0;var i=t,a=setInterval((function(){i.times<=0&&(i.getCodeFlag=!0,i.intervalFlag=!1,clearInterval(a)),i.times--}),1e3);t.formData.codeKey=e.key,t.$toast({position:"top",message:"发送验证码成功!"})}else t.$toast({position:"top",message:e.message})}))}})).catch((function(t){console.log(t)}))},login:function(t){var e=this;if(this.formData.codeKey){if(!this.loginFlag)return;this.loginFlag=!1;var i={mobile:this.formData.tel,user_id:this.$store.state.WXUserInfo.id,verification_key:this.formData.codeKey,verification_code:this.formData.code,openid:this.$store.state.WXUserInfo.open_id};Object(o["a"])(i).then((function(t){if(console.log(t),e.loginFlag=!0,"success"==t.status){e.$store.commit("setAppUserInfo",{token:t.token,expired_at:t.expired_at,id:t.data.id});var i={ac_id:e.$store.state.distributionInfo.ac_id,user_id:t.data.id};Object(o["b"])(i).then((function(t){})),e.closeDialog()}else e.$toast({position:"top",message:t.message})}))}else this.$toast({position:"top",message:"请先获取验证码"})}}},d=c,u=(i("6fe9"),i("2877")),f=Object(u["a"])(d,r,l,!1,null,"5e3f2ac4",null),h=f.exports,g={components:{toHome:n["a"],inviteLogin:h},data:function(){return{introduction:"",showToggleBtn:!1,showVideoBrief:!0,load:!1,getDataFlag:!0,data:{},is_buy:!1,showInviter:!1,ac_id:0,from_user_id:0,director:{},actors:[]}},created:function(){this.$shareConfig();var t=this.getUrlParam("ac_id"),e=this.getUrlParam("from_user_id");t&&e&&Number(t)&&Number(e)&&this.$store.commit("setDistributionInfo",{ac_id:Number(t),from_user_id:Number(e)}),this.$store.state.distributionInfo.ac_id&&this.$store.state.distributionInfo.from_user_id?this.getData():this.$router.push("/errorPage"),t&&e&&(this.ac_id=this.$store.state.distributionInfo.ac_id,this.from_user_id=this.$store.state.distributionInfo.from_user_id,this.showInviter=!0)},methods:{closeDialog:function(){this.showInviter=!1},getUrlParam:function(t){for(var e=window.location.search.substr(1).split("&"),i=0;i<e.length;i++)if(e[i].split("=")[0]==t)return e[i].split("=")[1];return!1},getData:function(){var t=this;if(this.load=!0,this.getDataFlag){this.getDataFlag=!1;var e={ac_id:this.$store.state.distributionInfo.ac_id,user_id:this.$store.state.WXUserInfo.id?this.$store.state.WXUserInfo.id:""};Object(o["d"])(e).then((function(e){console.log(e),t.data=e,t.actors=e.actors.filter((function(t,e,i){return"导演"!==t.actor_name})),t.director=e.actors.find((function(t,e,i){return"导演"==t.actor_name})).actor,t.introduction=e.introduction,t.is_buy=e.is_buy,t.load=!1,t.getDataFlag=!0}))}},WXPay:function(){var t=this;if(this.$store.state.appUserInfo.token)if(this.$store.state.WXUserInfo.id){var e={ac_id:this.$store.state.distributionInfo.ac_id,from_user_id:this.$store.state.distributionInfo.from_user_id,user_id:this.$store.state.WXUserInfo.id,openid:this.$store.state.WXUserInfo.open_id};Object(o["j"])(e).then((function(e){console.log(e),t.$payConfig(e.timeStamp,e.nonceStr,e.package,e.signType,e.paySign,(function(t){alert(JSON.stringify(t)),alert(JSON.stringify(this)),alert("支付成功"),window.location.href="https://h5.newtiming.com/payResult?result=true"}),(function(t){alert(JSON.stringify(t)),alert(JSON.stringify(this)),alert("支付失败"),router.push({name:"payResult",query:{result:!0}})}))}))}else{var i=encodeURI(window.location.origin+this.$route.path);location.replace("https://app.newtiming.com/api/v1/socials/authorizations?redirect_url="+i+"&user_id="+this.$store.state.appUserInfo.id)}else this.$router.push("/login")},toUser:function(){this.$router.push({name:"personalCenter"})},toShare:function(){this.$router.push({name:"share"})},handleWeappError:function(){console.log("跳转失败")},handleWeappLaunch:function(){console.log("跳转成功")},changeBrief:function(){this.showVideoBrief=!this.showVideoBrief}},watch:{introduction:function(){this.$nextTick((function(){var t=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).height),e=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).lineHeight);console.log(t,e),t>3*e?(console.log(1),this.showToggleBtn=!0):(console.log(2),this.showToggleBtn=!1)}))}}},p=g,v=(i("0175"),Object(u["a"])(p,a,s,!1,null,"12d58107",null));e["default"]=v.exports},"2fe9":function(t,e,i){},"6fe9":function(t,e,i){"use strict";var a=i("9d91"),s=i.n(a);s.a},"7db0":function(t,e,i){"use strict";var a=i("23e7"),s=i("b727").find,o=i("44d2"),n=i("ae40"),r="find",l=!0,c=n(r);r in[]&&Array(1)[r]((function(){l=!1})),a({target:"Array",proto:!0,forced:l||!c},{find:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),o(r)},"8e0a":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"toHome"},on:{click:t.toPages}},["detail"==t.toWhere?i("i",{staticClass:"iconfont icon-iconfontshangchengweijihuoeps"}):t._e(),"personalCenter"==t.toWhere?i("i",{staticClass:"iconfont icon-shouye1 toDetail"}):t._e(),"personalCenter"==t.toWhere?i("p",[t._v("个人中心")]):t._e(),"detail"==t.toWhere?i("p",[t._v("返回")]):t._e()])},s=[],o={name:"toHome",props:["toWhere"],methods:{toPages:function(){this.$router.push(this.toWhere)}}},n=o,r=(i("a6be"),i("2877")),l=Object(r["a"])(n,a,s,!1,null,"1da08a80",null);e["a"]=l.exports},"9d91":function(t,e,i){},a6be:function(t,e,i){"use strict";var a=i("2fe9"),s=i.n(a);s.a},d5c0:function(t,e,i){}}]);
//# sourceMappingURL=chunk-49df3d53.67ebddab.js.map