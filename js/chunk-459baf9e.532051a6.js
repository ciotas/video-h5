(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-459baf9e"],{1e3:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"detail"}},[o("van-overlay",{staticClass:"loadBox",attrs:{show:t.load,"z-index":1e4,"lock-scroll":!0}},[t.load?o("van-loading",{staticClass:"load",attrs:{type:"spinner",color:"#1989fa",vertical:!0}}):t._e()],1),o("div",{staticClass:"content"},[o("div",{staticClass:"swiperBox"},[o("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3}},t._l(t.data.acImages,(function(t,e){return o("van-swipe-item",{key:e},[o("img",{attrs:{src:t,alt:""}})])})),1)],1),o("div",{staticClass:"tip"},[t._v(" 《亮剑》导演张前执导 CCTV-1黄金档同步热播 新时光全网独家 ")]),o("div",{staticClass:"videoBaseInfo"},[o("div",{staticClass:"videoTitle"},[o("div",{staticClass:"posterBox"},[o("img",{attrs:{src:t.data.poster_v,alt:""}})]),o("div",{staticClass:"rightBox"},[o("p",{staticClass:"videoName"},[t._v(t._s(t.data.name))]),o("p",[o("span",{staticClass:"episodes"},[t._v("共"+t._s(t.data.video_num)+"集")]),t._l(t.data.tags,(function(e,i){return o("span",{key:i},[0!==i?o("span",[t._v("/")]):t._e(),t._v(" "+t._s(e)+" ")])}))],2),o("p",[t._v("导演 ："+t._s(t.director.name))]),o("p",[t._v(" 领衔主演 ："),t._l(t.actors,(function(e,i){return o("span",{key:i},[t._v(t._s(e.actor.name)+"、")])}))],2)])]),o("div",{staticClass:"videoBrief"},[o("div",{staticClass:"BriefBox",class:{shrink:t.showToggleBtn&&t.showVideoBrief}},[o("div",{ref:"videoBriefText",staticClass:"videoBriefText",domProps:{innerHTML:t._s(t.introduction)}}),t.showToggleBtn&&t.showVideoBrief?o("div",{staticClass:"ellipsis"},[t._v(" ... ")]):t._e()]),t.showToggleBtn?o("p",{staticClass:"changeBrief",on:{click:t.changeBrief}},[t._v(" "+t._s(t.showVideoBrief?"展开":"收起")+" ")]):t._e()]),o("div",{staticClass:"videoDetail",domProps:{innerHTML:t._s(t.data.intro)}}),o("div",{staticClass:"videoBuy"},[o("div",{staticClass:"price"},[o("span",{staticClass:"realPrice"},[t._v("￥"+t._s(t.data.real_price))]),o("span",{staticClass:"deletePrice"},[t._v("￥"+t._s(t.data.price))]),o("span",{staticClass:"rightMarker"},[t._v(t._s(t.data.video_num)+"集")])]),o("div",{staticClass:"tryWatch"},[o("p",{on:{click:t.toWatch}},[t._v("免费试看")])]),t.data.is_buy?o("div",{staticClass:"buyNow"},[t._v("已购买")]):o("div",{staticClass:"buyNow",on:{click:t.WXPay}},[t._v("立即抢购")])]),o("div",{staticClass:"shareBtn",on:{click:t.toShare}},[o("p",[t._v("邀请好友得")]),o("p",[o("span",[t._v(t._s(t.data.distribute_money))]),t._v(" 元 ")])])])]),o("to-home",{attrs:{toWhere:"personalCenter"}}),t.showInviter?o("invite-login",{attrs:{showInviter:t.showInviter,from_user_id:t.from_user_id,ac_id:t.ac_id},on:{closeDialog:t.closeDialog}}):t._e()],1)},a=[],s=(o("4de4"),o("7db0"),o("ac1f"),o("5319"),o("0a14")),n=o("8e0a"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"inviteLogin"}},[o("van-dialog",{class:{loginTrue:t.loginStatus},attrs:{"show-confirm-button":!1},scopedSlots:t._u([{key:"title",fn:function(){return[o("p",{staticClass:"avatar"},[o("img",{attrs:{src:t.dialogData.avatar}})]),o("i",{staticClass:"closeBtn iconfont icon-guanbi3",on:{click:t.closeDialog}})]},proxy:!0}]),model:{value:t.showInviter,callback:function(e){t.showInviter=e},expression:"showInviter"}},[[t.load?o("div",{staticClass:"loadBox"},[t.load?o("van-loading",{staticClass:"load",attrs:{type:"spinner",color:"#1989fa",vertical:!0}}):t._e()],1):t._e(),o("div",{staticClass:"inviter"},[o("p",{staticClass:"name"},[t._v(t._s(t.dialogData.user_name))]),o("p",{staticClass:"tip"},[t._v(" 邀您1元看大剧《"+t._s(t.dialogData.program_name)+"》，重温乒乓王者路 ")])]),t.loginStatus?o("div",{staticClass:"btnBox"},[o("van-button",{attrs:{type:"info"},on:{click:t.closeDialog}},[t._v("确认")])],1):o("van-form",{ref:"formRef",staticClass:"formBox",on:{submit:t.login}},[o("van-cell-group",{staticClass:"formCell telBox"},[o("van-field",{attrs:{placeholder:"请输入手机号",rules:t.formRule.tel,error:!1,name:"tel",type:"number"},model:{value:t.formData.tel,callback:function(e){t.$set(t.formData,"tel",e)},expression:"formData.tel"}})],1),o("van-cell-group",{staticClass:"formCell codeBox"},[o("van-field",{attrs:{placeholder:"请输入验证码",rules:t.formRule.code,error:!1,name:"code",type:"number",maxlength:4},scopedSlots:t._u([{key:"button",fn:function(){return[o("van-button",{staticClass:"getCodeBtn",class:{notClick:!t.getCodeFlag},attrs:{round:"",block:"",type:"info","native-type":"button",disabled:!t.getCodeFlag},on:{click:t.getCode}},[t.intervalFlag?o("span",[t._v("("+t._s(t.times)+")")]):t._e(),t._v(" 获取验证码 ")])]},proxy:!0}],null,!1,1907922443),model:{value:t.formData.code,callback:function(e){t.$set(t.formData,"code",e)},expression:"formData.code"}})],1),o("van-cell-group",{staticClass:"formCell submitBox"},[o("van-button",{staticClass:"submitBtn",attrs:{round:"",block:"",type:"info","native-type":"submit"}},[t._v("接受邀请")])],1)],1)]],2)],1)},l=[],c=(o("b0c0"),{name:"inviteLogin",props:["showInviter","from_user_id","ac_id"],data:function(){var t=function(t,e){var o=/^\d+$|^\d+[.]?\d+$/;return o.test(t)&&4==t.length};return{loginStatus:!1,getCodeFlag:!0,loginFlag:!0,intervalFlag:!1,load:!1,times:60,dialogData:{},formData:{tel:"",code:"",codeKey:""},formRule:{tel:[{required:!0,message:"手机号不可为空",trigger:"onChange"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确格式的手机号",trigger:"onChange"}],code:[{required:!0,message:"验证码不可为空",trigger:"onChange"},{validator:t,message:"验证码为长度为4的数字",trigger:"onChange"}]}}},created:function(){this.testOpenId(),this.getData()},methods:{testOpenId:function(){var t=this;Object(s["n"])({openid:this.$store.state.WXUserInfo.open_id}).then((function(e){console.log(e),"none"==e.status?t.loginStatus=!1:t.loginStatus=!0}))},getData:function(){var t=this;this.load=!0;var e={from_user_id:this.from_user_id,ac_id:this.ac_id};console.log(e),Object(s["e"])(e).then((function(e){console.log(e),t.dialogData=e.data,t.load=!1}))},closeDialog:function(){this.$emit("closeDialog")},getCode:function(){var t=this;this.$refs.formRef.validate("tel").then((function(e){if(t.getCodeFlag){t.getCodeFlag=!1;var o={mobile:t.formData.tel};Object(s["g"])(o).then((function(e){if(1e3==e.code){t.times=60,t.intervalFlag=!0;var o=t,i=setInterval((function(){o.times<=0&&(o.getCodeFlag=!0,o.intervalFlag=!1,clearInterval(i)),o.times--}),1e3);t.formData.codeKey=e.key,t.$toast({position:"top",message:"发送验证码成功!"})}else t.$toast({position:"top",message:e.message})}))}})).catch((function(t){console.log(t)}))},login:function(t){var e=this;if(this.formData.codeKey){if(!this.loginFlag)return;this.loginFlag=!1;var o={mobile:this.formData.tel,verification_key:this.formData.codeKey,verification_code:this.formData.code,name:this.$store.state.WXUserInfo.name,avatar:this.$store.state.WXUserInfo.avatar,openid:this.$store.state.WXUserInfo.open_id};Object(s["a"])(o).then((function(t){if(console.log(t),e.loginFlag=!0,"success"==t.status){e.$store.commit("setAppUserInfo",{token:t.token,id:t.data.id});var o={ac_id:e.$store.state.distributionInfo.ac_id,user_id:t.data.id};Object(s["b"])(o).then((function(t){})),e.closeDialog()}else e.$toast({position:"top",message:t.message})}))}else this.$toast({position:"top",message:"请先获取验证码"})}}}),d=c,u=(o("a359"),o("2877")),f=Object(u["a"])(d,r,l,!1,null,"08ebe5d2",null),h=f.exports,g={components:{toHome:n["a"],inviteLogin:h},data:function(){return{introduction:"",showToggleBtn:!1,showVideoBrief:!0,load:!1,getDataFlag:!0,data:{},is_buy:!1,showInviter:!1,ac_id:0,from_user_id:0,director:{},actors:[]}},created:function(){this.$store.state.distributionInfo.ac_id&&this.$store.state.distributionInfo.from_user_id?(this.getData(),this.ac_id=this.$store.state.distributionInfo.ac_id,this.from_user_id=this.$store.state.distributionInfo.from_user_id,this.showInviter=!0):this.$router.push("/errorPage"),this.$shareConfig()},methods:{closeDialog:function(){this.showInviter=!1},getData:function(){var t=this;if(this.load=!0,this.getDataFlag){this.getDataFlag=!1;var e={ac_id:this.$store.state.distributionInfo.ac_id?this.$store.state.distributionInfo.ac_id:"",user_id:this.$store.state.appUserInfo.id?this.$store.state.appUserInfo.id:""};Object(s["d"])(e).then((function(e){console.log(e),t.data=e,t.actors=e.actors.filter((function(t,e,o){return"导演"!==t.actor_name})),t.director=e.actors.find((function(t,e,o){return"导演"==t.actor_name})).actor,t.introduction=e.introduction,t.is_buy=e.is_buy,t.load=!1,t.getDataFlag=!0}))}},WXPay:function(){var t=this;if(this.$store.state.WXUserInfo.open_id)Object(s["n"])({openid:this.$store.state.WXUserInfo.open_id}).then((function(e){if(console.log(e),t.$store.commit("setAppUserInfo",{token:e.token,id:e.data.id}),"none"==e.status)t.$router.push("login");else{var o={ac_id:t.$store.state.distributionInfo.ac_id,from_user_id:t.$store.state.distributionInfo.from_user_id,user_id:t.$store.state.appUserInfo.id,openid:t.$store.state.WXUserInfo.open_id};Object(s["j"])(o).then((function(e){console.log(e),t.$payConfig(e.timeStamp,e.nonceStr,e.package,e.signType,e.paySign,(function(t){window.location.href="https://h5.newtiming.com/payResult?result=true"}),(function(t){window.location.href="https://h5.newtiming.com/payResult?result=false"}))}))}}));else{var e=encodeURIComponent(window.location.origin+this.$route.path);location.replace("https://app.newtiming.com/api/v1/socials/authorizations?redirect_url="+e)}},toUser:function(){this.$router.push({name:"personalCenter"})},toShare:function(){this.$router.push({name:"share"})},changeBrief:function(){this.showVideoBrief=!this.showVideoBrief},toWatch:function(){window.location.href="https://www.newtiming.com/h5/detailPlay"}},watch:{introduction:function(){this.$nextTick((function(){var t=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).height),e=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).lineHeight);console.log(t,e),t>3*e?(console.log(1),this.showToggleBtn=!0):(console.log(2),this.showToggleBtn=!1)}))}}},v=g,p=(o("565d"),Object(u["a"])(v,i,a,!1,null,"d10dfaba",null));e["default"]=p.exports},"2fe9":function(t,e,o){},"33b8":function(t,e,o){},"565d":function(t,e,o){"use strict";var i=o("33b8"),a=o.n(i);a.a},"7db0":function(t,e,o){"use strict";var i=o("23e7"),a=o("b727").find,s=o("44d2"),n=o("ae40"),r="find",l=!0,c=n(r);r in[]&&Array(1)[r]((function(){l=!1})),i({target:"Array",proto:!0,forced:l||!c},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),s(r)},"8e0a":function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"toHome"},on:{click:t.toPages}},["detail"==t.toWhere?o("i",{staticClass:"iconfont icon-iconfontshangchengweijihuoeps"}):t._e(),"personalCenter"==t.toWhere?o("i",{staticClass:"iconfont icon-shouye1 toDetail"}):t._e(),"personalCenter"==t.toWhere?o("p",[t._v("个人中心")]):t._e(),"detail"==t.toWhere?o("p",[t._v("返回")]):t._e()])},a=[],s={name:"toHome",props:["toWhere"],methods:{toPages:function(){this.$router.push(this.toWhere)}}},n=s,r=(o("a6be"),o("2877")),l=Object(r["a"])(n,i,a,!1,null,"1da08a80",null);e["a"]=l.exports},a359:function(t,e,o){"use strict";var i=o("d6fc"),a=o.n(i);a.a},a6be:function(t,e,o){"use strict";var i=o("2fe9"),a=o.n(i);a.a},d6fc:function(t,e,o){}}]);
//# sourceMappingURL=chunk-459baf9e.532051a6.js.map