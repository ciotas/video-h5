(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7741908e"],{"08c7":function(t,e,s){},1e3:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"detail"}},[s("van-overlay",{staticClass:"loadBox",attrs:{show:t.load,"z-index":1e4,"lock-scroll":!0}},[t.load?s("van-loading",{staticClass:"load",attrs:{type:"spinner",color:"#1989fa",vertical:!0}}):t._e()],1),s("div",{staticClass:"content"},[s("div",{staticClass:"swiperBox"},[s("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3}},t._l(t.data.acImages,(function(t,e){return s("van-swipe-item",{key:e},[s("img",{attrs:{src:t,alt:""}})])})),1)],1),s("div",{staticClass:"tip"},[t._v(" 《亮剑》导演张前执导 CCTV-1黄金档同步热播 新时光全网独家 ")]),s("div",{staticClass:"videoBaseInfo"},[s("div",{staticClass:"videoTitle"},[s("div",{staticClass:"posterBox"},[s("img",{attrs:{src:t.data.poster_v,alt:""}})]),s("div",{staticClass:"rightBox"},[s("p",{staticClass:"videoName"},[t._v(t._s(t.data.name))]),s("p",[s("span",{staticClass:"episodes"},[t._v("共"+t._s(t.data.video_num)+"集")]),t._l(t.data.tags,(function(e,a){return s("span",{key:a},[0!==a?s("span",[t._v("/")]):t._e(),t._v(" "+t._s(e)+" ")])}))],2),s("p",[t._v("导演 ：")]),s("p",[t._v("领衔主演 ：")])])]),s("div",{staticClass:"videoBrief"},[s("div",{staticClass:"BriefBox",class:{shrink:t.showToggleBtn&&t.showVideoBrief}},[s("div",{ref:"videoBriefText",staticClass:"videoBriefText",domProps:{innerHTML:t._s(t.introduction)}}),t.showToggleBtn&&t.showVideoBrief?s("div",{staticClass:"ellipsis"},[t._v(" ... ")]):t._e()]),t.showToggleBtn?s("p",{staticClass:"changeBrief",on:{click:t.changeBrief}},[t._v(" "+t._s(t.showVideoBrief?"展开":"收起")+" ")]):t._e()]),t._m(0),s("div",{staticClass:"videoBuy"},[s("div",{staticClass:"price"},[s("span",{staticClass:"realPrice"},[t._v("￥"+t._s(t.data.real_price))]),s("span",{staticClass:"deletePrice"},[t._v("￥"+t._s(t.data.price))]),s("span",{staticClass:"rightMarker"},[t._v(t._s(t.data.video_num)+"集")])]),s("div",{staticClass:"tryWatch"},[s("wx-open-launch-weapp",{attrs:{id:"toWeapp",username:"gh_1653716eeae2",path:"/pages/videoDetail/videoDetail.html"},on:{error:t.handleWeappError,launch:t.handleWeappLaunch}},[[s("p",[t._v("免费试看")])]],2)],1),t.data.is_buy?s("div",{staticClass:"buyNow"},[t._v("已购买")]):s("div",{staticClass:"buyNow",on:{click:t.WXPay}},[t._v("立即抢购")])]),s("div",{staticClass:"shareBtn",on:{click:t.toShare}},[s("p",[t._v("邀请好友得")]),s("p",[s("span",[t._v(t._s(t.data.real_price*t.data.rate/100))]),t._v(" 元 ")])])])]),s("to-home",{attrs:{toWhere:"personalCenter"}}),t.showInviter?s("invite-login",{attrs:{showInviter:t.showInviter,from_user_id:t.from_user_id,ac_id:t.ac_id},on:{closeDialog:t.closeDialog}}):t._e()],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"videoDetail"},[a("img",{attrs:{src:s("2bf4"),alt:""}})])}],o=(s("ac1f"),s("5319"),s("841c"),s("1276"),s("0a14")),n=s("8e0a"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"inviteLogin"}},[s("van-dialog",{class:{loginTrue:t.loginStatus},attrs:{"show-confirm-button":!1},scopedSlots:t._u([{key:"title",fn:function(){return[s("p",{staticClass:"avatar"},[s("img",{attrs:{src:t.dialogData.avatar,alt:""}})]),s("i",{staticClass:"closeBtn iconfont icon-guanbi3",on:{click:t.closeDialog}})]},proxy:!0}]),model:{value:t.showInviter,callback:function(e){t.showInviter=e},expression:"showInviter"}},[[s("div",{staticClass:"inviter"},[s("p",{staticClass:"name"},[t._v(t._s(t.dialogData.user_name))]),s("p",{staticClass:"tip"},[t._v(" 邀您1元看大剧《"+t._s(t.dialogData.program_name)+"》，重温乒乓王者路 ")])]),t.loginStatus?s("div",{staticClass:"btnBox"},[s("van-button",{attrs:{type:"info"},on:{click:t.closeDialog}},[t._v("确认")])],1):s("van-form",{ref:"formRef",staticClass:"formBox",on:{submit:t.login}},[s("van-cell-group",{staticClass:"formCell telBox"},[s("van-field",{attrs:{placeholder:"请输入手机号",rules:t.formRule.tel,error:!1,name:"tel",type:"number"},model:{value:t.formData.tel,callback:function(e){t.$set(t.formData,"tel",e)},expression:"formData.tel"}})],1),s("van-cell-group",{staticClass:"formCell codeBox"},[s("van-field",{attrs:{placeholder:"请输入验证码",rules:t.formRule.code,error:!1,name:"code",type:"number",maxlength:4},scopedSlots:t._u([{key:"button",fn:function(){return[s("van-button",{staticClass:"getCodeBtn",class:{notClick:!t.getCodeFlag},attrs:{round:"",block:"",type:"info","native-type":"button",disabled:!t.getCodeFlag},on:{click:t.getCode}},[t.intervalFlag?s("span",[t._v("("+t._s(t.times)+")")]):t._e(),t._v(" 获取验证码 ")])]},proxy:!0}],null,!1,1907922443),model:{value:t.formData.code,callback:function(e){t.$set(t.formData,"code",e)},expression:"formData.code"}})],1),s("van-cell-group",{staticClass:"formCell submitBox"},[s("van-button",{staticClass:"submitBtn",attrs:{round:"",block:"",type:"info","native-type":"submit"}},[t._v("接受邀请")])],1)],1)]],2)],1)},l=[],c={name:"inviteLogin",props:["showInviter","from_user_id","ac_id"],data:function(){var t=function(t,e){var s=/^\d+$|^\d+[.]?\d+$/;return s.test(t)&&4==t.length};return{loginStatus:!1,getCodeFlag:!0,loginFlag:!0,intervalFlag:!1,times:60,dialogData:{},formData:{tel:"",code:"",codeKey:""},formRule:{tel:[{required:!0,message:"手机号不可为空",trigger:"onChange"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确格式的手机号",trigger:"onChange"}],code:[{required:!0,message:"验证码不可为空",trigger:"onChange"},{validator:t,message:"验证码为长度为4的数字",trigger:"onChange"}]}}},created:function(){this.loginStatus=this.testToken(),this.getData()},methods:{getData:function(){var t=this,e={from_user_id:this.from_user_id,ac_id:this.ac_id};console.log(e),Object(o["e"])(e).then((function(e){console.log(e),t.dialogData=e.data}))},testToken:function(){if(this.$store.state.appUserInfo.token){var t=new Date(this.$store.state.appUserInfo.expired_at);t=t.getTime();var e=(new Date).getTime();return!(e>t)}return!1},closeDialog:function(){this.$emit("closeDialog")},getCode:function(){var t=this;this.$refs.formRef.validate("tel").then((function(e){if(t.getCodeFlag){t.getCodeFlag=!1;var s={mobile:t.formData.tel};Object(o["g"])(s).then((function(e){if(1e3==e.code){t.times=60,t.intervalFlag=!0;var s=t,a=setInterval((function(){s.times<=0&&(s.getCodeFlag=!0,s.intervalFlag=!1,clearInterval(a)),s.times--}),1e3);t.formData.codeKey=e.key,t.$toast({position:"top",message:"发送验证码成功!"})}else t.$toast({position:"top",message:e.message})}))}})).catch((function(t){console.log(t)}))},login:function(t){var e=this;if(this.formData.codeKey){if(!this.loginFlag)return;this.loginFlag=!1;var s={mobile:this.formData.tel,user_id:this.$store.state.WXUserInfo.id,verification_key:this.formData.codeKey,verification_code:this.formData.code,openid:this.$store.state.WXUserInfo.open_id};Object(o["a"])(s).then((function(t){if(console.log(t),e.loginFlag=!0,"success"==t.status){e.$store.commit("setAppUserInfo",{token:t.token,expired_at:t.expired_at,id:t.data.id});var s={ac_id:e.$store.state.distributionInfo.ac_id,user_id:t.data.id};Object(o["b"])(s).then((function(t){})),e.closeDialog()}else e.$toast({position:"top",message:t.message})}))}else this.$toast({position:"top",message:"请先获取验证码"})}}},d=c,u=(s("e548"),s("2877")),f=Object(u["a"])(d,r,l,!1,null,"37fca965",null),h=f.exports,g={components:{toHome:n["a"],inviteLogin:h},data:function(){return{introduction:"",showToggleBtn:!1,showVideoBrief:!0,load:!1,getDataFlag:!0,data:{},is_buy:!1,showInviter:!1,ac_id:0,from_user_id:0}},created:function(){var t=this.getUrlParam("ac_id"),e=this.getUrlParam("from_user_id");t&&e&&this.$store.commit("setDistributionInfo",{ac_id:t,from_user_id:e}),this.$store.state.distributionInfo.ac_id&&this.$store.state.distributionInfo.from_user_id?this.getData():this.$router.push("/errorPage"),t&&e&&(this.ac_id=t,this.from_user_id=e,this.showInviter=!0),this.$shareConfig()},methods:{closeDialog:function(){this.showInviter=!1},getUrlParam:function(t){for(var e=window.location.search.substr(1).split("&"),s=0;s<e.length;s++)if(e[s].split("=")[0]==t)return e[s].split("=")[1];return!1},getData:function(){var t=this;if(this.load=!0,this.getDataFlag){this.getDataFlag=!1;var e={ac_id:this.$store.state.distributionInfo.ac_id,user_id:this.$store.state.WXUserInfo.id?this.$store.state.WXUserInfo.id:""};Object(o["d"])(e).then((function(e){console.log(e),t.data=e,t.introduction=e.introduction,t.is_buy=e.is_buy,t.load=!1,t.getDataFlag=!0}))}},WXPay:function(){var t=this;if(this.$store.state.appUserInfo.token)if(this.$store.state.WXUserInfo.id){var e={ac_id:this.$store.state.distributionInfo.ac_id,from_user_id:this.$store.state.distributionInfo.from_user_id,user_id:this.$store.state.WXUserInfo.id,openid:this.$store.state.WXUserInfo.open_id};Object(o["j"])(e).then((function(e){console.log(e),t.$payConfig(e.timeStamp,e.nonceStr,e.package,e.signType,e.paySign,(function(){console.log("支付成功"),this.$router.push({name:"payResult",query:{result:!0}})}),(function(){console.log("支付失败"),this.$router.push({name:"payResult",query:{result:!1}})}))}))}else{var s=encodeURI(window.location.origin+this.$route.path);location.replace("https://app.newtiming.com/api/v1/socials/authorizations?redirect_url="+s+"&user_id="+this.$store.state.appUserInfo.id)}else this.$router.push("/login")},toUser:function(){this.$router.push({name:"personalCenter"})},toShare:function(){this.$router.push({name:"share"})},handleWeappError:function(){console.log("跳转失败")},handleWeappLaunch:function(){console.log("跳转成功")},changeBrief:function(){this.showVideoBrief=!this.showVideoBrief}},watch:{introduction:function(){this.$nextTick((function(){var t=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).height),e=parseFloat(window.getComputedStyle(this.$refs.videoBriefText).lineHeight);console.log(t,e),t>3*e?(console.log(1),this.showToggleBtn=!0):(console.log(2),this.showToggleBtn=!1)}))}}},p=g,v=(s("30b4"),Object(u["a"])(p,a,i,!1,null,"3b124c8c",null));e["default"]=v.exports},"2bf4":function(t,e,s){t.exports=s.p+"img/distributionRule.8637c404.png"},"2fe9":function(t,e,s){},"30b4":function(t,e,s){"use strict";var a=s("08c7"),i=s.n(a);i.a},"8e0a":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"toHome"},on:{click:t.toPages}},["detail"==t.toWhere?s("i",{staticClass:"iconfont icon-iconfontshangchengweijihuoeps"}):t._e(),"personalCenter"==t.toWhere?s("i",{staticClass:"iconfont icon-shouye1 toDetail"}):t._e(),"personalCenter"==t.toWhere?s("p",[t._v("个人中心")]):t._e(),"detail"==t.toWhere?s("p",[t._v("返回")]):t._e()])},i=[],o={name:"toHome",props:["toWhere"],methods:{toPages:function(){this.$router.push(this.toWhere)}}},n=o,r=(s("a6be"),s("2877")),l=Object(r["a"])(n,a,i,!1,null,"1da08a80",null);e["a"]=l.exports},"99a1":function(t,e,s){},a6be:function(t,e,s){"use strict";var a=s("2fe9"),i=s.n(a);i.a},e548:function(t,e,s){"use strict";var a=s("99a1"),i=s.n(a);i.a}}]);
//# sourceMappingURL=chunk-7741908e.a67607d3.js.map